<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>(*^▽^*)</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/80a95484ea2876e6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/80a95484ea2876e6.css" data-n-g=""/><link rel="preload" href="/_next/static/css/f8f6338530cfd437.css" as="style"/><link rel="stylesheet" href="/_next/static/css/f8f6338530cfd437.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee7e63bc15b31913.js" defer=""></script><script src="/_next/static/chunks/framework-2c79e2a64abdb08b.js" defer=""></script><script src="/_next/static/chunks/main-7477d36a73a3487c.js" defer=""></script><script src="/_next/static/chunks/pages/_app-d15f243f6b85624f.js" defer=""></script><script src="/_next/static/chunks/171-0943d13a71220321.js" defer=""></script><script src="/_next/static/chunks/pages/blog/detail/%5Bid%5D-0499978da9bd8e44.js" defer=""></script><script src="/_next/static/PP0RItdVRqRIwwr_F0xvU/_buildManifest.js" defer=""></script><script src="/_next/static/PP0RItdVRqRIwwr_F0xvU/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="layout_main-container__jR90l"><main class="layout_main__E22hH"><div style="width:15em"><nav class="sidebar_nav__EFmKd"><div class="Avatar_container__egCID"><div class="Avatar_image-container__9WrGh"><img src="/images/avatar.png" alt="mingjianglong" class="Avatar_avatar__oORu6"/><h2>龙江</h2><h3 style="font-weight:normal;padding-top:.6em;color:grey">Jiang Long</h3><h4 style="padding-top:1.3em">等风也等你~</h4><span class="Avatar_my-face__hbhE_">ღゝ◡╹)ノ♡</span></div><div></div></div><a style="color:black" href="/">开心☺</a><a style="color:black" href="/blog">Blog</a><a style="color:black" href="/archive">归档</a><a style="color:black" href="/resume">简介</a></nav></div><div style="flex:1;height:100vh;display:flex;flex-direction:column;overflow-y:hidden"><div style="height:100%;padding:7em;overflow:scroll"><h1 style="font-family:&#x27;Ubuntu&#x27;, sans-serif;font-size:calc(1rem + 1.5vw);color:#1d2b35;padding:1em 0;overflow-wrap:break-word">支付宝扫码支付总结</h1>
<h3 style="font-family:&#x27;Maven Pro&#x27;, sans-serif;font-size:calc(1rem + 0.5vw);color:#1d2b35;padding:.6em 0;overflow-wrap:break-word">流程</h3>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">用户扫码之后,后端重定向进入对应支付宝h5页面，用户选择钱包点击支付按钮。前端根据对应信息(商品信息、优惠信息、钱包信息等)获取交易号并且根据该交易号拉起支付宝收银台，在收到支付宝支付回调之后，将相应的支付状态上报后端,根据上报结果判断是否展示广告,至此结束。</p>
<h3 style="font-family:&#x27;Maven Pro&#x27;, sans-serif;font-size:calc(1rem + 0.5vw);color:#1d2b35;padding:.6em 0;overflow-wrap:break-word">问题点</h3>
<ul style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013e6;margin:1vh 0 1vh calc(2vw);overflow-wrap:break-word">
<li>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">前端技术栈</p>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">前端选择的是Vue3。项目很小,前面版本使用原生开发,后面迭代了两个版本,受够了dom操作繁琐,重构为Vue(避免了开发人员dom操作,就不得不将Vue运行时打包进项目,也算是一种取舍吧)</p>
</li>
<li>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">是否前后端分离</p>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">最终选择是前后不分离(实际上开发还是分离),主要是考虑用户请求是否是可控的(伪造请求)。其实我们是支付宝H5的页面,可以使用支付宝的授权跳转，这样就可以使得来源可控。</p>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">事实证明还是要分离，不然开发过程中苦的是自己。后端再小的变动，前端都需要打包，将对应文件放在对应位置(这一步虽然可以代码完成)。然后再把项目推服务。</p>
</li>
<li>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">加载速度(打包体积优化)</p>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">打包支持了gzip</p>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">terse minify以及移除了console</p>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">打包分析的时候发现decimal.js包体积很大(有部分金额计算涉及小数点,所以引入该包),对该包做了minify</p>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">请求合并，将第三方包打进vendor</p>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">还有vite默认支持的treeshaking</p>
</li>
<li>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">版本控制</p>
<p style="font-family:&#x27;Source Sans Pro&#x27;, sans-serif;font-size:calc(1rem + 0.1vw);color:#071013f2;margin:0vh 0 1vh 0;overflow-wrap:break-word">hash</p>
</li>
</ul></div></div></main></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"metaData":{"title":"友宝支付宝扫码支付","description":"公司需要在现有售货机上需要在售货机支付宝扫码支付上使用企业福利钱包","tags":["支付"],"keywords":["支付"],"id":"支付宝扫码支付","create":1687337636375,"lastUpdate":1692955775571},"content":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    h1: \"h1\",\n    h3: \"h3\",\n    p: \"p\",\n    ul: \"ul\",\n    li: \"li\"\n  }, _provideComponents(), props.components);\n  return _jsxs(_Fragment, {\n    children: [_jsx(_components.h1, {\n      children: \"支付宝扫码支付总结\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"流程\"\n    }), \"\\n\", _jsx(_components.p, {\n      children: \"用户扫码之后,后端重定向进入对应支付宝h5页面，用户选择钱包点击支付按钮。前端根据对应信息(商品信息、优惠信息、钱包信息等)获取交易号并且根据该交易号拉起支付宝收银台，在收到支付宝支付回调之后，将相应的支付状态上报后端,根据上报结果判断是否展示广告,至此结束。\"\n    }), \"\\n\", _jsx(_components.h3, {\n      children: \"问题点\"\n    }), \"\\n\", _jsxs(_components.ul, {\n      children: [\"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsx(_components.p, {\n          children: \"前端技术栈\"\n        }), \"\\n\", _jsx(_components.p, {\n          children: \"前端选择的是Vue3。项目很小,前面版本使用原生开发,后面迭代了两个版本,受够了dom操作繁琐,重构为Vue(避免了开发人员dom操作,就不得不将Vue运行时打包进项目,也算是一种取舍吧)\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsx(_components.p, {\n          children: \"是否前后端分离\"\n        }), \"\\n\", _jsx(_components.p, {\n          children: \"最终选择是前后不分离(实际上开发还是分离),主要是考虑用户请求是否是可控的(伪造请求)。其实我们是支付宝H5的页面,可以使用支付宝的授权跳转，这样就可以使得来源可控。\"\n        }), \"\\n\", _jsx(_components.p, {\n          children: \"事实证明还是要分离，不然开发过程中苦的是自己。后端再小的变动，前端都需要打包，将对应文件放在对应位置(这一步虽然可以代码完成)。然后再把项目推服务。\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsx(_components.p, {\n          children: \"加载速度(打包体积优化)\"\n        }), \"\\n\", _jsx(_components.p, {\n          children: \"打包支持了gzip\"\n        }), \"\\n\", _jsx(_components.p, {\n          children: \"terse minify以及移除了console\"\n        }), \"\\n\", _jsx(_components.p, {\n          children: \"打包分析的时候发现decimal.js包体积很大(有部分金额计算涉及小数点,所以引入该包),对该包做了minify\"\n        }), \"\\n\", _jsx(_components.p, {\n          children: \"请求合并，将第三方包打进vendor\"\n        }), \"\\n\", _jsx(_components.p, {\n          children: \"还有vite默认支持的treeshaking\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsxs(_components.li, {\n        children: [\"\\n\", _jsx(_components.p, {\n          children: \"版本控制\"\n        }), \"\\n\", _jsx(_components.p, {\n          children: \"hash\"\n        }), \"\\n\"]\n      }), \"\\n\"]\n    })]\n  });\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, props)\n  })) : _createMdxContent(props);\n}\nreturn {\n  default: MDXContent\n};\n","frontmatter":{},"scope":{}}},"__N_SSG":true},"page":"/blog/detail/[id]","query":{"id":"支付宝扫码支付"},"buildId":"PP0RItdVRqRIwwr_F0xvU","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>